---
import PostLayout from "../layouts/PostLayout.astro"
import Input from "../Components/Input.astro"
import BotonPrincipal from "../Components/BotonPrincipal.astro"
import AceptarTerminos from "../Components/AceptarTerminos.astro"
import SelectBoxTI from "../Components/SelectBoxTI.astro"


interface Props {
  id1: string;
  
}

const { id1, } = Astro.props;

---


<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <link href="https://fonts.googleapis.com/css?family=Inter&display=swap" rel="stylesheet" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Josefin+Slab:ital,wght@0,100..700;1,100..700&display=swap" rel="stylesheet">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <style>
        body {
            font-family: "Josefin Slab", serif;
            font-optical-sizing: auto;
        }
        .relative input {
            padding-right: 2.5rem; /* Añade espacio a la derecha del input para el icono */
        }
        .relative i {
            right: 1rem; /* Ajusta la posición del icono */
        }
        .error-message {
            color: red;
            font-size: 0.875rem; /* Tamaño de fuente pequeño */
            margin-top: -0.5rem; /* Ajusta el margen para alinear mejor con los inputs */
            margin-bottom: 1rem; /* Espacio debajo del mensaje */
            text-align: left; /* Alineación del texto */
            width: 100%; /* Asegura que ocupe todo el ancho del contenedor */
        }
    </style>
</head>
<body>
    <div class="flex h-screen items-center justify-center gap-x-72"> <!--contenedor principal -->
        <div class="flex content-center"> <!--contenedor del formulario -->
            <form id="formu" class="form flex flex-col w-96 items-center gap-4" action="/Inicio" method="post">

                <div class="logo-sena flex m-auto items-center justify-center w-80 h-28 bg-custom-green rounded-bl-[50px] rounded-br-[50px]"> <!--caja del logo -->
                    <img class="sena w-20 h-20" src="/public/img/logoSena.png" width="10" height="10">
                </div>

                <div class="registro flex flex-col items-center gap-2 min-w-96">
                    <div class="text-3xl">REGISTRO</div>

                    <div class="relative w-full">
                        <Input type="text" Text="" placeholder="Nombre Completo:" id="registroNombre" />
                        <span id="nombreError" class="error-message"></span>
                    </div>

                    <div class="relative w-full">
                        <Input type="text" Text="" placeholder="Número De Documento:" id="numeroDc" />
                        <span id="numeroDcError" class="error-message"></span>
                    </div>

                    <div class="relative w-full">
                        <SelectBoxTI Text=""/>
                    </div>

                    <div class="relative w-full">
                        <Input type="email" Text="" placeholder="Correo:" id="CorreoRegistro"/>
                        <span id="correoError" class="error-message"></span>
                    </div>

                    <div class="relative w-full">
                        <Input type="text" Text="" placeholder="Teléfono:" id="telefono" />
                        <span id="telefonoError" class="error-message"></span>
                    </div>

                    <div class="relative w-full">
                        <Input type="text" Text="" placeholder="Nombre De la Empresa:" id="nombreEmpresa"/>
                    </div>

                    <div class="relative w-full">
                        <Input type="password" Text="" placeholder="Contraseña:" id="contrasenaRegistro"/>
                        <i class='bx bx-show cursor-pointer absolute right-3 top-2/4 transform -translate-y-2/4' id="togglePasswordRegistro"></i>
                        <span id="contrasenaError" class="error-message"></span>
                    </div>

                    <div class="relative w-full">
                        <Input type="password" Text="" placeholder="Confirmar Contraseña:" id="confirmarContrasena"/>
                        <i class='bx bx-show cursor-pointer absolute right-3 top-2/4 transform -translate-y-2/4' id="togglePasswordConfirmacion"></i>
                        <span id="confirmarContrasenaError" class="error-message"></span>
                    </div>

                    <div class="w-full flex items-start">
                        <AceptarTerminos Text="Aceptar Términos y Condiciones" id={id1} />
                    </div>
                    <a href="/Inicio">
                    <BotonPrincipal Text="Registrarse" id="Registro"></BotonPrincipal>
                </a>
                    <h3 class="w-[200px] h-[44px] py-[10px] cursor-pointer text-[15px] mt-3 self-center">Ya tienes cuenta?
                    <a href="/Inicio" class="text-blue-500 underline decoration-1">Iniciar Sesión</a></h3>
                </div>
            </form>
        </div>

        <div class="hidden lg:block w-full lg:w-[800px]">
            <img class="w-[800px] h-[800px]" src="../../public/img/registro.png" alt="Registro">
        </div>

    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const formu = document.getElementById('formu') as HTMLFormElement;
            const nombre = document.getElementById('registroNombre') as HTMLInputElement;
            const correoRegistro = document.getElementById('CorreoRegistro') as HTMLInputElement;
            const contrasenaRegistro = document.getElementById('contrasenaRegistro') as HTMLInputElement;
            const confirmarContrasena = document.getElementById('confirmarContrasena') as HTMLInputElement;
            const numeroDc = document.getElementById('numeroDc') as HTMLInputElement;
            const telefono = document.getElementById('telefono') as HTMLInputElement;
            const nombreError = document.getElementById('nombreError');
            const correoError = document.getElementById('correoError');
            const contrasenaError = document.getElementById('contrasenaError');
            const confirmarContrasenaError = document.getElementById('confirmarContrasenaError');
            const numeroDcError = document.getElementById('numeroDcError');
            const telefonoError = document.getElementById('telefonoError');
            const togglePasswordRegistro = document.getElementById('togglePasswordRegistro');
            const togglePasswordConfirmacion = document.getElementById('togglePasswordConfirmacion');


            if (formu) {
        // Resetear el formulario
        formu.reset();
    }

    if (togglePasswordRegistro) {
        // Toggle password visibility
        togglePasswordRegistro.addEventListener('click', function() {
            if (contrasenaRegistro) {
                const type = contrasenaRegistro.getAttribute('type') === 'password' ? 'text' : 'password';
                contrasenaRegistro.setAttribute('type', type);
            }
            this.classList.toggle('bx-show');
            this.classList.toggle('bx-hide');
        });
    }

            if (formu) {
                formu.addEventListener('submit', function(event) {
                    let valid = true;
                    if (nombreError) nombreError.textContent = '';
                    if (correoError) correoError.textContent = '';
                    if (contrasenaError) contrasenaError.textContent = '';
                    if (confirmarContrasenaError) confirmarContrasenaError.textContent = '';
                    if (numeroDcError) numeroDcError.textContent = '';
                    if (telefonoError) telefonoError.textContent = '';

                    // Validación del nombre
                    const nombreValue = nombre ? nombre.value.trim() : '';
                    if (!nombreValue || !/^[A-Za-z\s]+$/.test(nombreValue)) {
                        valid = false;
                        if (nombreError) nombreError.textContent = 'Ingrese un nombre válido.';
                    }

                    // Validación del correo electrónico
                    const correoValue = correoRegistro ? correoRegistro.value.trim() : '';
                    if (!correoValue) {
                        valid = false;
                        if (correoError) correoError.textContent = 'El correo electrónico es requerido.';
                    } else if (!/\S+@\S+\.\S+/.test(correoValue)) {
                        valid = false;
                        if (correoError) correoError.textContent = 'El correo electrónico debe tener formato válido.';
                    }

                    // Validación de la contraseña
                    const contrasenaValue = contrasenaRegistro ? contrasenaRegistro.value : '';
                    if (!contrasenaValue || contrasenaValue.length < 8) {
                        valid = false;
                        if (contrasenaError) contrasenaError.textContent = 'La contraseña debe tener al menos 8 caracteres.';
                    } else if (!/[A-Z]/.test(contrasenaValue)) {
                        valid = false;
                        if (contrasenaError) contrasenaError.textContent = 'El correo electrónico debe contener al menos una letra mayúscula.';
                    }

                    // Validación de la confirmación de contraseña
                    const confirmarContrasenaValue = confirmarContrasena ? confirmarContrasena.value : '';
                    if (contrasenaValue !== confirmarContrasenaValue) {
                        valid = false;
                        if (confirmarContrasenaError) confirmarContrasenaError.textContent = 'Las contraseñas no coinciden.';
                    }

                    // Validación del número de documento
                    const numeroDcValue = numeroDc ? numeroDc.value.trim() : '';
                    if (!numeroDcValue || isNaN(parseInt(numeroDcValue)) || numeroDcValue.length !== 10) {
                        valid = false;
                        if (numeroDcError) numeroDcError.textContent = 'Ingrese un número de documento válido de 10 dígitos.';
                    }

                    // Validación del teléfono
                    const telefonoValue = telefono ? telefono.value.trim() : '';
                    if (telefonoValue.length !== 10 || isNaN(parseInt(telefonoValue))) {
                        valid = false;
                        if (telefonoError) telefonoError.textContent = 'Ingrese un número de teléfono válido de 10 dígitos.';
                    }

                    if (!valid) {
                        event.preventDefault();
                    } else {
                        // Aquí puedes redirigir al usuario a la página de destino después de enviar el formulario
                        window.location.href = '/Inicio';
                    }
                });
            }

            window.addEventListener('pageshow', function(event) {
                if (event.persisted && formu) {
                    formu.reset();
                }
            });
        });

    </script>
</body>
</html>